{
    "sourceFile": "app/Http/Controllers/Subscriptions/SubscriptionController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1655860251679,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1655944739051,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,9 @@\n use Illuminate\\Http\\Request;\n \n class SubscriptionController extends Controller\n {\n-    public function index(){\n+    public function index(Request $request){\n+        dd($request->user()->createSetupIntent());\n         return view('subscriptions.checkout');\n     }\n }\n"
                },
                {
                    "date": 1655944761969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,7 +8,9 @@\n class SubscriptionController extends Controller\n {\n     public function index(Request $request){\n         dd($request->user()->createSetupIntent());\n-        return view('subscriptions.checkout');\n+        return view('subscriptions.checkout',[\n+            'intent'=>'abc'\n+        ]);\n     }\n }\n"
                },
                {
                    "date": 1655944979728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,10 +7,9 @@\n \n class SubscriptionController extends Controller\n {\n     public function index(Request $request){\n-        dd($request->user()->createSetupIntent());\n         return view('subscriptions.checkout',[\n-            'intent'=>'abc'\n+            'intent'=>$request->user()->createSetupIntent()\n         ]);\n     }\n }\n"
                },
                {
                    "date": 1655948127855,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,10 +6,16 @@\n use Illuminate\\Http\\Request;\n \n class SubscriptionController extends Controller\n {\n-    public function index(Request $request){\n-        return view('subscriptions.checkout',[\n-            'intent'=>$request->user()->createSetupIntent()\n+    public function index(Request $request)\n+    {\n+        return view('subscriptions.checkout', [\n+            'intent' => $request->user()->createSetupIntent()\n         ]);\n     }\n+\n+    public function store(Request $request)\n+    {\n+        dd($request->token);\n+    }\n }\n"
                },
                {
                    "date": 1656033642615,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,7 +15,11 @@\n     }\n \n     public function store(Request $request)\n     {\n-        dd($request->token);\n+        $this->validate(\n+            $request,\n+            ['token'=>'required']\n+        );\n     }\n+    Plan::\n }\n"
                },
                {
                    "date": 1656033761536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,6 +20,6 @@\n             $request,\n             ['token'=>'required']\n         );\n     }\n-    Plan::\n+    $plan = Plan::where('slug', $request->plan)->first();\n }\n"
                },
                {
                    "date": 1656033775434,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n \n namespace App\\Http\\Controllers\\Subscriptions;\n \n use App\\Http\\Controllers\\Controller;\n+use App\\Models\\Plan;\n use Illuminate\\Http\\Request;\n \n class SubscriptionController extends Controller\n {\n@@ -19,7 +20,7 @@\n         $this->validate(\n             $request,\n             ['token'=>'required']\n         );\n+        $plan = Plan::where('slug', $request->plan)->first();\n     }\n-    $plan = Plan::where('slug', $request->plan)->first();\n }\n"
                },
                {
                    "date": 1656033821028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,7 +20,9 @@\n         $this->validate(\n             $request,\n             ['token'=>'required']\n         );\n-        $plan = Plan::where('slug', $request->plan)->first();\n+        $plan = Plan::where('slug', $request->plan)\n+        ->orWhere('slug', 'monthly')\n+        ->first();\n     }\n }\n"
                },
                {
                    "date": 1656034015611,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,11 +18,15 @@\n     public function store(Request $request)\n     {\n         $this->validate(\n             $request,\n-            ['token'=>'required']\n+            ['token' => 'required']\n         );\n+\n         $plan = Plan::where('slug', $request->plan)\n-        ->orWhere('slug', 'monthly')\n-        ->first();\n+            ->orWhere('slug', 'monthly')\n+            ->first();\n+        $request->user()->newSubscription('default', $plan->stripe_id)->create();\n+\n+        return back();\n     }\n }\n"
                },
                {
                    "date": 1656034081903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,9 +24,9 @@\n \n         $plan = Plan::where('slug', $request->plan)\n             ->orWhere('slug', 'monthly')\n             ->first();\n-        $request->user()->newSubscription('default', $plan->stripe_id)->create();\n+        $request->user()->newSubscription('default', $plan->stripe_id)->create($request->token);\n \n         return back();\n     }\n }\n"
                }
            ],
            "date": 1655860251679,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Subscriptions;\n\nuse App\\Http\\Controllers\\Controller;\nuse Illuminate\\Http\\Request;\n\nclass SubscriptionController extends Controller\n{\n    public function index(){\n        return view('subscriptions.checkout');\n    }\n}\n"
        }
    ]
}